import{r as x,a as J,n as K,o as O,b as a,c as f,d,e as o,f as s,w as t,u as c,j as U,v as j,L as A,z as g,H as D,M as H,g as n,k as I,t as V,F as P,C as T,N as q,E as v}from"./index-CAVot8kD.js";import{_ as G,h as Q}from"./_plugin-vue_export-helper-CZBBfLPA.js";const R={class:"login-page"},W={class:"login-container"},X={class:"login-card-wrapper"},Y={class:"card-header"},Z={class:"header-content"},$={key:0,class:"login-form-container"},ee={class:"account-info"},se={class:"account-list"},te={class:"account-item"},oe={class:"account-item"},le={class:"account-item"},ae={class:"account-item"},ne={class:"account-item"},re={key:1,class:"profile-container"},ie={class:"profile-header"},de={class:"profile-value"},ue={class:"logout-container"},ce={__name:"Login",setup(me){const l=x({username:"",password:""}),m=J(!1),p=x({username:"",roles:[]}),k=K(()=>!!localStorage.getItem("auth_token")),w=()=>{const r=localStorage.getItem("auth_user"),e=localStorage.getItem("auth_roles");p.username=r||"",p.roles=e?JSON.parse(e):[]};O(()=>{w()});const h=async()=>{if(!l.username||!l.password){v.warning("請輸入使用者名稱與密碼");return}m.value=!0;try{const r=await Q.login({username:l.username,password:l.password});localStorage.setItem("auth_token",r.token),localStorage.setItem("auth_user",r.username),localStorage.setItem("auth_roles",JSON.stringify(r.roles||[])),w(),v.success("登入成功"),window.dispatchEvent(new CustomEvent("auth-change"))}catch(r){v.error(r.message||"登入失敗")}finally{m.value=!1}},C=()=>{l.username="",l.password=""},E=()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_roles"),w(),v.success("已登出"),window.dispatchEvent(new CustomEvent("auth-change"))};return(r,e)=>{const _=a("el-icon"),i=a("el-tag"),z=a("el-input"),y=a("el-form-item"),b=a("el-button"),N=a("el-form"),L=a("el-divider"),B=a("el-alert"),S=a("el-descriptions-item"),F=a("el-descriptions"),M=a("el-card");return d(),f("div",R,[o("div",W,[o("div",X,[s(M,{class:"main-card",shadow:"always"},{header:t(()=>[o("div",Y,[o("div",Z,[s(_,{class:"header-icon"},{default:t(()=>[s(c(I))]),_:1}),e[2]||(e[2]=o("span",{class:"header-title"},"使用者登入",-1))]),k.value?(d(),g(i,{key:0,type:"success",size:"large"},{default:t(()=>[...e[3]||(e[3]=[n("已登入",-1)])]),_:1})):(d(),g(i,{key:1,type:"info",size:"large"},{default:t(()=>[...e[4]||(e[4]=[n("未登入",-1)])]),_:1}))])]),default:t(()=>[k.value?(d(),f("div",re,[o("div",ie,[s(_,{class:"profile-icon"},{default:t(()=>[s(c(I))]),_:1}),e[18]||(e[18]=o("h3",null,"當前使用者資訊",-1))]),s(F,{title:"",column:1,border:"",class:"profile-descriptions"},{default:t(()=>[s(S,{label:"使用者名稱"},{default:t(()=>[o("span",de,V(p.username),1)]),_:1}),s(S,{label:"角色"},{default:t(()=>[(d(!0),f(P,null,T(p.roles,u=>(d(),g(i,{key:u,type:"info",size:"large",class:"role-tag"},{default:t(()=>[n(V(u),1)]),_:2},1024))),128))]),_:1})]),_:1}),o("div",ue,[s(b,{type:"danger",onClick:E,size:"large",class:"logout-button"},{default:t(()=>[s(_,null,{default:t(()=>[s(c(q))]),_:1}),e[19]||(e[19]=o("span",{style:{"margin-left":"8px"}},"登出",-1))]),_:1})])])):(d(),f("div",$,[s(N,{model:l,"label-width":"120px",class:"login-form",size:"large"},{default:t(()=>[s(y,{label:"使用者名稱",class:"form-item-large"},{default:t(()=>[s(z,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=u=>l.username=u),placeholder:"請輸入使用者名稱","prefix-icon":c(U),size:"large",clearable:""},null,8,["modelValue","prefix-icon"])]),_:1}),s(y,{label:"密碼",class:"form-item-large"},{default:t(()=>[s(z,{modelValue:l.password,"onUpdate:modelValue":e[1]||(e[1]=u=>l.password=u),type:"password",placeholder:"請輸入密碼","prefix-icon":c(A),size:"large","show-password":"",clearable:"",onKeyup:j(h,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1}),s(y,{class:"form-item-large"},{default:t(()=>[s(b,{type:"primary",onClick:h,loading:m.value,size:"large",class:"login-button"},{default:t(()=>[m.value?D("",!0):(d(),g(_,{key:0},{default:t(()=>[s(c(H))]),_:1})),e[5]||(e[5]=o("span",{style:{"margin-left":"8px"}},"登入",-1))]),_:1},8,["loading"]),s(b,{onClick:C,size:"large",class:"reset-button"},{default:t(()=>[...e[6]||(e[6]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),s(L,null,{default:t(()=>[...e[7]||(e[7]=[n("預設帳號資訊",-1)])]),_:1}),o("div",ee,[s(B,{type:"info",closable:!1,"show-icon":""},{title:t(()=>[o("div",se,[o("div",te,[s(i,{type:"success",size:"small"},{default:t(()=>[...e[8]||(e[8]=[n("管理員",-1)])]),_:1}),e[9]||(e[9]=o("span",null,"admin / admin123",-1))]),o("div",oe,[s(i,{type:"primary",size:"small"},{default:t(()=>[...e[10]||(e[10]=[n("會計",-1)])]),_:1}),e[11]||(e[11]=o("span",null,"accountant / accountant123",-1))]),o("div",le,[s(i,{type:"warning",size:"small"},{default:t(()=>[...e[12]||(e[12]=[n("審計",-1)])]),_:1}),e[13]||(e[13]=o("span",null,"auditor / auditor123",-1))]),o("div",ae,[s(i,{type:"info",size:"small"},{default:t(()=>[...e[14]||(e[14]=[n("出納",-1)])]),_:1}),e[15]||(e[15]=o("span",null,"cashier / cashier123",-1))]),o("div",ne,[s(i,{type:"danger",size:"small"},{default:t(()=>[...e[16]||(e[16]=[n("查看者",-1)])]),_:1}),e[17]||(e[17]=o("span",null,"viewer / viewer123",-1))])])]),_:1})])]))]),_:1})])])])}}},fe=G(ce,[["__scopeId","data-v-895ebbc1"]]);export{fe as default};
