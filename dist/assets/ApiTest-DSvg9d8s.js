import{_ as T,a as x,v as N,c as G}from"./_plugin-vue_export-helper-CZBBfLPA.js";import{r as V,a as S,b as o,c as p,d as n,f as l,w as a,z as m,H as w,g as i,F as B,C as J,e as u,t as f,E as c}from"./index-CAVot8kD.js";const O={class:"api-test-container"},z={class:"result-header"},F={style:{"margin-left":"10px"}},j={key:0},D={key:1},H={class:"json-display"},L={__name:"ApiTest",setup(M){const r=V({accounts:!1,vendors:!1,customers:!1}),s=S(null),h=async()=>{r.accounts=!0,s.value=null;try{const e=await x.getAllAccounts();s.value={success:!0,api:"GET /api/accounts",data:Array.isArray(e)?e:[e],raw:e},c.success("科目列表 API 測試成功！")}catch(e){s.value={success:!1,api:"GET /api/accounts",error:e.message||JSON.stringify(e),raw:e},c.error("科目列表 API 測試失敗："+(e.message||"未知錯誤"))}finally{r.accounts=!1}},b=async()=>{r.vendors=!0,s.value=null;try{const e=await N.getAllVendors();s.value={success:!0,api:"GET /api/vendors",data:Array.isArray(e)?e:[e],raw:e},c.success("供應商列表 API 測試成功！")}catch(e){s.value={success:!1,api:"GET /api/vendors",error:e.message||JSON.stringify(e),raw:e},c.error("供應商列表 API 測試失敗："+(e.message||"未知錯誤"))}finally{r.vendors=!1}},I=async()=>{r.customers=!0,s.value=null;try{const e=await G.getAllCustomers();s.value={success:!0,api:"GET /api/customers",data:Array.isArray(e)?e:[e],raw:e},c.success("客戶列表 API 測試成功！")}catch(e){s.value={success:!1,api:"GET /api/customers",error:e.message||JSON.stringify(e),raw:e},c.error("客戶列表 API 測試失敗："+(e.message||"未知錯誤"))}finally{r.customers=!1}},k=()=>{s.value=null,c.info("已清除測試結果")};return(e,t)=>{const d=o("el-button"),y=o("el-space"),C=o("el-tag"),g=o("el-alert"),P=o("el-table-column"),E=o("el-table"),_=o("el-card");return n(),p("div",O,[l(_,{class:"test-card"},{header:a(()=>[...t[0]||(t[0]=[u("div",{class:"card-header"},[u("span",null,"後端 API 連接測試")],-1)])]),default:a(()=>[l(y,{direction:"vertical",size:"large",style:{width:"100%"}},{default:a(()=>[l(y,{wrap:""},{default:a(()=>[l(d,{type:"primary",onClick:h,loading:r.accounts},{default:a(()=>[...t[1]||(t[1]=[i(" 測試科目列表 API ",-1)])]),_:1},8,["loading"]),l(d,{type:"success",onClick:b,loading:r.vendors},{default:a(()=>[...t[2]||(t[2]=[i(" 測試供應商列表 API ",-1)])]),_:1},8,["loading"]),l(d,{type:"warning",onClick:I,loading:r.customers},{default:a(()=>[...t[3]||(t[3]=[i(" 測試客戶列表 API ",-1)])]),_:1},8,["loading"]),l(d,{type:"info",onClick:k},{default:a(()=>[...t[4]||(t[4]=[i(" 清除結果 ",-1)])]),_:1})]),_:1}),s.value?(n(),m(_,{key:0,shadow:"hover"},{header:a(()=>[u("div",z,[l(C,{type:s.value.success?"success":"danger"},{default:a(()=>[i(f(s.value.success?"成功":"失敗"),1)]),_:1},8,["type"]),u("span",F,f(s.value.api),1)])]),default:a(()=>{var A;return[s.value.success?(n(),p("div",j,[l(g,{title:`成功獲取 ${((A=s.value.data)==null?void 0:A.length)||0} 條記錄`,type:"success",closable:!1,style:{"margin-bottom":"15px"}},null,8,["title"]),l(E,{data:s.value.data,stripe:"",border:"",style:{width:"100%"},"max-height":"400"},{default:a(()=>[(n(!0),p(B,null,J(s.value.data[0]||{},(R,v)=>(n(),m(P,{key:v,prop:v,label:v,"min-width":120},null,8,["prop","label"]))),128))]),_:1},8,["data"])])):(n(),p("div",D,[l(g,{title:s.value.error||"未知錯誤",type:"error",closable:!1},null,8,["title"])]))]}),_:1})):w("",!0),s.value&&s.value.raw?(n(),m(_,{key:1,shadow:"hover"},{header:a(()=>[...t[5]||(t[5]=[u("span",null,"原始響應數據",-1)])]),default:a(()=>[u("pre",H,f(JSON.stringify(s.value.raw,null,2)),1)]),_:1})):w("",!0)]),_:1})]),_:1})])}}},K=T(L,[["__scopeId","data-v-68a3a44f"]]);export{K as default};
